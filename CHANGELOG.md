# 更新日志

## v1.8.2 - 2026-01-21

### 🔧 改进

#### 📦 依赖升级
- **Mermaid 版本升级** - 从 10.6.1 升级到 11.12.2（最新版本，2025-12-02 发布）
  - ✨ 修复了 Gantt 图表日期验证问题
  - 🐛 解决了 UI 相关问题
  - 📊 支持更多图表类型和功能增强
  - 🔒 改进了安全性和性能

**影响范围**：
- 更新 `public/lib/mermaid/mermaid.min.js` (2.8MB → 2.7MB)
- 更新测试文件 `test-zoom.html` 中的 CDN 链接
- 更新文档中的版本引用

---

## v1.8.1 - 2026-01-21

### 🔧 改进

#### 🔍 图表缩放增强
- 📈 **提升缩放范围** - 图表最大缩放倍率从 500% 提升至 2000%（测试文件从 300% 提升至 2000%）
- 🎯 **更好的细节查看** - 允许超大图表的极致放大，便于查看复杂流程图和 UML 图的细节
- ✅ **确认 Mermaid 版本** - 使用 Mermaid 11.12.2，与文档保持一致

**技术细节**：
- 更新 `standalone-app.js` 中的 `adjustZoom()` 方法（从 5x 到 20x）
- 更新测试文件 `test-zoom.html`（从 3x 到 20x）和 `增强版缩放功能.js`（从 5x 到 20x）保持一致
- 最小缩放：50%，最大缩放：2000%

---

## v1.8.0 - 2026-01-15

### ✨ 新功能

#### 📑 文档目录导航功能
- 📋 **目录面板** - 在预览区右侧显示当前文档的标题大纲
- 🔗 **快速跳转** - 点击目录项可快速跳转到对应章节
- 🎯 **滚动高亮** - 滚动文档时自动高亮当前所在的目录项
- 📊 **多级缩进** - 支持 H1-H6 六级标题，按层级缩进显示
- 💾 **记忆状态** - 记住目录面板的显示/隐藏状态

#### 🔍 文档内查找功能
- 🔎 **全局搜索** - 在当前打开的文档中查找任意文本
- ⌨️ **快捷键支持** - `Ctrl+F` 打开查找面板，`ESC` 关闭
- 🔄 **导航匹配** - 上一个/下一个按钮，或 `Enter`/`Shift+Enter`
- 🌈 **高亮显示** - 所有匹配项黄色高亮，当前匹配项橙色突出
- 📊 **计数显示** - 显示当前位置和总匹配数（如 `3/15`）

**使用方法**：
- 点击工具栏的目录图标（📋）显示/隐藏目录面板
- 点击目录项跳转到对应标题
- 按 `Ctrl+F` 打开查找面板，输入要查找的内容

---

## v1.7.1 - 2026-01-15

### 🐛 修复

#### 📁 同名文件夹历史记录问题
- 🔧 **修复同名覆盖问题** - 不同路径但同名的文件夹现在可以同时保存在历史记录中
- 🏷️ **区分标记** - 同名文件夹会显示序号标记（如 `docs (1)`、`docs (2)`）以便区分
- ⏰ **时间提示** - 鼠标悬停同名文件夹时显示添加时间，帮助识别不同目录
- 🎯 **精确高亮** - 使用 `isSameEntry()` API 精确判断当前活动文件夹，避免同名混淆
- ✅ **精确判重** - 使用 `isSameEntry()` 判断是否为同一文件夹，而非仅比较名称

**技术实现**：
- 使用 File System Access API 的 `isSameEntry()` 方法替代名称比较
- 为历史记录添加唯一标识符和时间戳
- 渲染时统计同名文件夹并生成区分显示

---

## v1.7.0 - 2026-01-12

### ✨ 新功能

#### 📁 最近打开文件夹功能
- 🗂️ **历史记录** - 自动保存最近打开的10个文件夹
- 🔄 **快速切换** - 点击文件夹名称即可切换工作目录
- 🎯 **智能高亮** - 当前活动文件夹自动高亮显示
- 🗑️ **灵活管理** - 鼠标悬停显示删除按钮，可移除不需要的文件夹
- 💾 **持久化存储** - 使用 IndexedDB 保存，关闭浏览器后依然保留

### 📝 功能详解

**工作原理**：
- 每次打开新文件夹时，自动添加到"最近打开"列表
- 最多保存10个文件夹，超过后自动删除最旧的记录
- 重复打开同一文件夹会更新其时间戳，保持在列表顶部

**使用场景**：
- 在多个项目文档之间快速切换
- 管理不同类别的笔记（工作、学习、个人）
- 临时查看其他文件夹，然后快速返回主工作区

**技术实现**：
- 升级 IndexedDB 到 v2，新增 `recentFolders` object store
- 使用 File System Access API 保存文件夹句柄
- 自动检查和请求访问权限

### 🎨 UI 改进

- 在侧边栏添加"最近打开"区域
- 优化文件夹列表样式，支持悬停效果
- 添加删除按钮，仅在鼠标悬停时显示

详细文档：[最近打开文件夹功能说明](docs/recent-folders-feature.md)

---

## v1.6.0 - 2026-01-09

### ✨ 新功能

#### UML 图表缩放功能
- 🔍 **双击放大** - 双击任意 Mermaid 图表即可全屏查看
- 🎮 **多种控制方式** - 支持按钮、键盘快捷键、鼠标滚轮缩放
- 📏 **灵活缩放** - 支持 50%-300% 缩放范围
- 🎨 **精美界面** - 全屏模态框，毛玻璃效果，流畅动画
- ⚡ **性能优化** - GPU 加速，不影响原图渲染

### 🎮 控制方式

**鼠标操作**：
- 双击图表 - 打开缩放视图
- 点击 [+] - 放大
- 点击 [−] - 缩小
- 点击 [⟲] - 重置
- 滚轮 - 连续缩放

**键盘快捷键**：
- `+` / `=` - 放大
- `-` - 缩小
- `0` - 重置到 100%
- `ESC` - 关闭

### 🔧 改进

- 优化 Mermaid 渲染流程，渲染完成后自动附加缩放事件
- 改进图表悬停效果，增加阴影和鼠标指针变化
- 添加图表提示："双击放大查看"

---

## v1.5.0 - 2026-01-09

### ✨ 新功能

#### Mermaid 图表主题优化
- 🎨 **主题自动切换** - Mermaid 图表现在会根据深色/浅色模式自动切换主题
- 📊 **更好的显示效果** - 优化了图表的边距、边框和背景样式
- 🔄 **实时更新** - 切换主题时图表自动重新渲染
- 💡 **UML 图支持** - 完美支持类图、时序图、部署图等 UML 图表

### 🔧 改进

- 优化 Mermaid 配置，添加 flowchart、sequence、gantt 等图表的特定设置
- 改进图表容器样式，支持大型图表的横向滚动
- 添加图表加载和错误状态提示
- 移除重复的内联样式，统一使用 CSS 文件

---

## v1.4.0 - 2026-01-09

### 🔧 改进

#### 简化视图模式
- 🗑️ **移除编辑模式** - 去除单独的编辑模式，简化界面操作
- 👀 **双模式切换** - 保留预览模式和分栏模式
- ✏️ **分栏编辑** - 在分栏模式下可以同时编辑和预览
- 🎯 **更简洁** - 减少按钮，界面更清爽

**理由**：编辑模式与分栏模式功能重复，保留分栏模式可以同时满足编辑和预览的需求，使界面更简洁易用。

---

## v1.3.0 - 2026-01-09

### ✨ 新功能

#### 文件夹记忆功能
- 🔖 **自动恢复** - 下次打开时自动加载上次的文件夹
- 🗄️ **IndexedDB 存储** - 使用浏览器数据库持久化保存文件夹句柄
- 🔐 **智能权限管理** - 自动检测和请求文件系统访问权限
- ⚡ **即开即用** - 无需每次重新选择文件夹，提升工作效率

### 🔧 改进

- 优化启动流程，自动恢复上次工作状态
- 改进权限处理逻辑，提供更友好的提示信息
- 增强错误处理，支持权限过期自动提示

---

## v1.2.0 - 2026-01-09

### ✨ 新功能

#### 可调整大小的分栏模式
- 🎯 **拖动调整** - 中间分隔线现在可以拖动，自由调整编辑器和预览区域的比例
- 📝 **默认分栏** - 打开文件时默认启用分栏模式，提供最佳编辑体验
- 💾 **记忆功能** - 自动保存你的分栏比例设置，下次打开时自动恢复
- 🎨 **视觉反馈** - 悬停和拖动时提供清晰的视觉提示

#### 多编码支持
- 🌐 **自动检测** - 智能识别 UTF-8、GBK、GB2312、GB18030、Big5 等编码
- 📋 **手动选择** - 工具栏提供编码选择器，支持手动指定编码格式
- 🔍 **BOM 检测** - 自动识别文件字节顺序标记
- ✅ **中文友好** - 完美支持 Windows 记事本保存的 GBK 编码文件

#### 高级 Markdown 支持
- 📐 **数学公式** - KaTeX 渲染，支持 LaTeX 语法
- 📊 **Mermaid 图表** - 支持流程图、序列图、甘特图、类图、状态图、饼图等
- 💻 **代码高亮** - 180+ 种编程语言语法高亮

### 🔧 改进

- 优化文件加载性能
- 改进编码检测算法
- 增强分栏模式的响应式体验
- 优化数学公式渲染性能
- 改进 Mermaid 图表渲染

### 📚 文档

- 新增《分栏模式使用指南》
- 新增《编码支持说明》
- 新增《完整功能演示》
- 更新《快速开始指南》

---

## v1.1.0 - 2026-01-08

### ✨ 新功能
- 📂 文件系统访问 API 支持
- 🎨 深色/浅色主题切换
- 🔍 文件搜索功能
- 💾 实时保存编辑

### 🔧 改进
- 优化界面布局
- 改进文件树渲染
- 增强错误处理

---

## v1.0.0 - 2026-01-07

### 🎉 首次发布
- 📂 基础文件浏览功能
- 👀 Markdown 预览
- ✏️ 基础编辑功能
- 💻 代码语法高亮
- 📱 响应式设计

---

## 路线图

### 即将推出
- [ ] 垂直分栏模式（上下布局）
- [ ] 导出为 PDF
- [ ] 多标签页支持
- [ ] 文档大纲导航
- [ ] 快捷键自定义

### 考虑中
- [ ] Vim 模式
- [ ] 拼写检查
- [ ] Git 集成
- [ ] 云端同步
- [ ] 协作编辑

---

**感谢使用 MD Viewer！** 🎉
